<section id="block-{{ forloop.index }}" class="uk-testimonials-1 uk-section-large uk-position-relative uk-background-cover uk-background-{{ block.background.color | default: 'default' }}" 
  style="{% if block.background.image %}background-image: url({% if block.background.image contains '#' %}{{ block.background.image }}{% else %}{{ block.background.image | absolute_url }}{% endif %});{% endif %}">
  {%- if block.background.overlay.color != '' -%}
    <div class="uk-position-cover" style="background: {{ block.background.overlay.color }}; opacity: {{ block.background.overlay.opacity | default: '0.6' }}"></div>
  {%- endif -%}

  {% if block.heading and block.heading != empty %}
    <div class="uk-container uk-text-{{ block.align }}">
      <div class="uk-section-heading-container uk-margin-large-bottom uk-container-small{% if block.align == 'center' %} uk-margin-auto{% endif %} uk-text-{{ block.align | default: 'left' }} uk-{{ block.color | default: 'dark' }}">
        {% if block.superheading != empty %}
          <div class="uk-section-superheading uk-margin-xsmall-bottom">{{ block.superheading }}</div>
        {% endif %}        
        {% if block.heading != empty %}
          <h2 class="uk-section-heading uk-margin-remove-top uk-margin-remove-bottom">{{ block.heading }}</h2>
        {% endif %}
        {% if block.text != empty %}
          <div class="uk-text-lead{% if block.heading %} uk-margin-xsmall-top{% endif %}">{{ block.text  }}</div>
        {% endif %}
        {% if block.copy != empty %}
          <div class="uk-text-content uk-margin-medium-top">{{ block.copy | markdownify  }}</div>
        {% endif %}
      </div>
    </div>
  {% endif %}
  
  <div class="uk-container uk-position-relative uk-{{ block.color | default: 'dark' }}">
    <div data-uk-slider="autoplay: true; autoplay-interval: 6000; pause-on-hover: false">

      <div class="uk-position-relative">

        <div class="uk-slider-container">
          <ul class="uk-slider-items uk-child-width-1-1">
            {% for slide in block.testimonials %}
              <li>
                <div class="uk-grid-large uk-flex uk-flex-middle" data-uk-grid>
                  <div class="uk-width-1-3 uk-visible@m">
                    <img data-src="{% if slide.image contains 'http' %}{{ slide.image }}{% else %}{{ slide.image | absolute_url }}{% endif %}" data-width data-height src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==" data-uk-img alt="{{ slide.heading }}">
                  </div>
                  <div class="uk-width-expand">
                    <img src="{{ '/assets/img/stars.svg' | absolute_url }}" width="340" alt="Rating">
                    {% if slide.heading != empty %}
                      <h3 class="uk-h2 uk-section-heading uk-line-height-one">{{ slide.heading }}</h3>
                    {% endif %}                    
                    {% if slide.text != empty %}
                      <div class="uk-margin-top uk-text-content"><q>{{ slide.text }}</q></div>
                    {% endif %} 
                    {% if slide.author != empty %}
                      <div class="uk-margin-top uk-margin-medium-left uk-text-large">&#8212; {{ slide.author }}</div>
                    {% endif %}                    
                  </div>
                </div>
              </li>
            {% endfor %}
          </ul>
        </div>

        <div class="uk-hidden@m">
          <a class="uk-position-center-left uk-position-small" href="#" data-uk-slidenav-previous data-uk-slider-item="previous"></a>
          <a class="uk-position-center-right uk-position-small" href="#" data-uk-slidenav-next data-uk-slider-item="next"></a>
        </div>

        <div class="uk-visible@m">
          <a class="uk-position-center-left-out uk-position-small" href="#" data-uk-slidenav-previous="ratio: 1.4" data-uk-slider-item="previous"></a>
          <a class="uk-position-center-right-out uk-position-small" href="#" data-uk-slidenav-next="ratio: 1.4" data-uk-slider-item="next"></a>
        </div>

      </div>

      <ul class="uk-slider-nav uk-dotnav uk-flex-center uk-margin"></ul>

    </div>
  </div>
</section>